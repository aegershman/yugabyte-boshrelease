<% p("databases.roles", []).each do |role| %>

CREATE ROLE IF NOT EXISTS "<%= role["name"] %>" AND LOGIN = true;

<% if role["password"] %>
ALTER ROLE "<%= role["name"] %>" WITH PASSWORD = '<%= role["password"] %>';
<% end %>

<% if role["permissions"] %>
<%# https://docs.yugabyte.com/latest/api/ycql/ddl_alter_role/ %>
ALTER ROLE "<%= role["name"] %>" WITH <%= role["permissions"].join(' AND ') %>;
<% end %

<% end %>
