---
name: yb-tserver

description: |
  https://docs.yugabyte.com/latest/reference/configuration/yb-tserver/

templates:
  bin/post-deploy.sh: bin/post-deploy
  bin/pre-start.sh: bin/pre-start
  config/bpm.erb.yml: config/bpm.yml
  config/cqlshrc.erb: config/cqlshrc
  config/tserver.conf.erb: config/tserver.conf
  config/ycql.roles.cql.erb: config/ycql.roles.cql

packages:
  - python-2.7
  - yugabyte

consumes:
  - name: yb-master
    type: conn

provides:
  - name: yb-tserver
    type: conn

properties:
  rpc_bind_addresses_port:
    default: 9100
  server_broadcast_addresses_port:
    default: 9100
  gflags:
    description: extra "--key=value" properties to pass to the conf file
    example: |
      gflags:
        default_memory_limit_to_ram_ratio: 0.85
        max_log_size: 256
        minloglevel: 0
        placement_cloud: aws
        placement_region: us-west-2
        stderrthreshold: 2
        stop_logging_if_full_disk: true
  ycql.databases.superusers:
    description: |
      until we get to putting a more fine-grained RBAC model in place
      on startup, we'll just assume every created user is a superuser
      https://docs.yugabyte.com/latest/api/ycql/ddl_alter_role/
    example: |
      ycql:
        databases:
          superusers:
            - name: hank_hill
              password: propane_bwaaah
