---
name: yb-admin

description: |
  https://docs.yugabyte.com/latest/admin/yb-admin/
  https://docs.yugabyte.com/latest/deploy/manual-deployment/verify-deployment/#optional-setup-yedis-api

templates:
  bin/pre-start.sh: bin/pre-start
  bin/run.sh: bin/run
  bin/yb-admin.sh.erb: bin/yb-admin.sh
  config/bpm.yml: config/bpm.yml
  config/certs/ca.crt.erb: config/certs/ca.crt

packages:
  - yugabyte

consumes:
  - name: yb-master
    type: yb-master-address-link

properties:
  master_addresses_port:
    default: 7100
  timeout_ms:
    description: The RPC timeout, in milliseconds. A value of 0 means donâ€™t wait; -1 means wait indefinitely.
    default: 60000

  tls.enabled:
    description: |
      Whether to attempt connecting to the cluster with TLS enabled.
      If the master nodes have `use_node_to_node_encryption` passed, this
      will be required.
    default: false
  tls.node.ca:
    description: "CA root required for key/cert verification"

  commands:
    description: |
      list of command sequences to loop over and pass individually to `yb-admin -master_addresses masteraddresses <your_command_string_here>`
      e.g., each string in "commands" will be executed as it's own individual call to `yb-admin`
    default: []
    example: |
      commands:
        - get_universe_config
        - setup_redis_table
        - create_snapshot ydb test_tb
        - all_masters_have_universe_key_in_memory somekeyid
